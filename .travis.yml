dist: bionic

language: c

services: docker

env:
  global:
    - secure: "EMy91ro1MQP3ueQad/kpkTICxcxae8bSopdb1m9ky8zz4OSvu95x6kU7rzkZ5YMQeWQiFf+FJWluB0s6STQ+4y6QllvBoVxJTo58w6yT+Ij7w+J1dIZpMk9BejvBuUtwS6evbVHN2fjZyNegUPbBZbl14wb5M51bJ9SyTqcH8bGgOmL+3s68nHSWwIDbrq5IufPg634m0YHZT0GjwGlDdvdIzJ4Ps5cfDxxXx2SWmhHO5lrGnekhC9hrlc3B0F3C7Jvow35Sp+snuEySk9Nq6vQQKO5y2rrr/sxciM3IdGwW7Z7wkILRAR0Mzbz6lQQ8PalnwVOzSxQBYbuinY1dLFr4BXkJdniS1ULx4h+PBCe3FQVH1p9QK/omM7qMJWCGLrmXngRvSnrfxSRmDsnZQsfn6RXgv3CIX0vIUCQ4GDdBhszTWr2Pda+0ulhYmVmSaiVXCT4imoLPDw5FS5WUVW90IN+Yifh7Eaw2SmQKV7lk95rN399o0uprL4mXgeTSqSxxwxiWd8+1d4d/DbBfXBRJ1lE5+LL7rz8iI2zRYCGOezC3R8cLA07rtnWlnpqgU7TfwEmiP3CdMKZlqbzH8FhrDYituLiyqnBIb33xJ24dORwWB1UvMP4LTpDjldFzEVUV2gaNSLU+y1mkj8KTrDZuumH5olVAJsCC9fSxN/4="

before_install:
  - docker pull mirisbowring/texlive_ctan_basic:2019
  - chmod +x ./script/texbuild.sh

script:
  - mkdir tempfiles
  - find . -maxdepth 1 -name "*.html" -type f -exec mv {} tempfiles \;
  - find . -maxdepth 1 -name "*.css" -type f -exec mv {} tempfiles \;
  - docker run --rm -it
      --volume="$PWD:/data"
      mirisbowring/texlive_ctan_basic:2019
      ./script/texbuild.sh
  - rm -f *.aux *.xref *.tmp *.4tc *.4ct *.idv *.lg *.dvi *.logs *.html *.css
  - rm -v .make4ht
  - rm -rf script _posts-tex script
  - find tempfiles -maxdepth 1 -type f -exec mv {} . \;
  - rm -rf tempfiles
  - rm -v .travis.yml

deploy:
  provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  repo: brandonhewer/brandonhewer.github.io
  target_branch: master
  keep_history: true
  on:
    branch: master
